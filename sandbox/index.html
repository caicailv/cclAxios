<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Document</title>
  </head>
  <body>
    <script type="module">
      import axios from '../dist/axios.js'
      ;(async function () {
        function loadJs() {
          var oHead = document.getElementsByTagName('head')[0] // 在head标签中创建创建script
          var oScript = document.createElement('script')
          oScript.type = 'text/javascript'
          oScript.src = '/axios.min.js'
          oScript.defer = true
          oHead.appendChild(oScript)
          console.error('正在使用官方版axios')
        }
        const pTime = (time) =>
          new Promise((resolve) => {
            setTimeout(resolve, time)
          })
        // loadJs()
        // await pTime(500)
        // const source = CancelToken.source()
        // setTimeout(() => {
        //   source.cancel('Operation canceled by the user.')
        // }, 20)

        // axios.interceptors.request.use(async function config1(config) {
        //   console.log('config1', config)
        //   await pTime(1500)
        //   return config
        // })
        // axios.interceptors.request.use(async function config2(config) {
        //   console.log('config2', config)
        //   await pTime(1500)
        //   return config
        // })
        // axios.interceptors.response.use(
        //   (res) => {
        //     console.log('response', res)
        //     return res
        //   },
        //   (err) => {
        //     console.error('nnerr', err)
        //   }
        // )
        const CancelToken = axios.CancelToken
        let cancel
        axios
          .get('/apb', {
            cancelToken: new CancelToken((callback) => {
              cancel = callback
            }),
          })
          .then((res) => {
            // console.log(res)
          })
          .catch((err) => {
            console.log('catch err', err)
          })
        // cancel('ccc')
      })()
    </script>
  </body>
</html>
